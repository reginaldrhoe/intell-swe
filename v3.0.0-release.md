# Intelligent Software Engineering Framework (intell-swe) v3.0.0

![RAG-POC Logo](./docs/Logo%20design%20featurin.png#width=75px;height=38px)

**Release Date**: January 26, 2026

## üéØ Major Release: Multiuser Architecture & Production Deployment

**Release Focus**: Complete architectural overhaul to support multiuser deployment, PostgreSQL-first database, centralized framework hosting, and per-user task isolation with role-based access control.

---

## ‚ú® Key Features

### Multiuser Mode (Core Architecture)
- **Single Shared Host**: Framework deployed once (e.g., `https://intelligent-framework.mycorp.com`)
- **Per-User Scoping**: All tasks/queries scoped by `user_id`; users see only their own work
- **Admin Visibility**: Administrators can view all tasks across all users
- **GitLab OAuth**: Seamless authentication with GitLab; user identity injected server-side

### Database Enhancements
- **PostgreSQL Support**: Prefer Postgres DSN for production; SQLite fallback for dev
- **User Management**: Dedicated `users` table with session management
- **Task Metadata**: Tasks now include `user_id`, `repo_ref`, `branch`, `logo_url` for full traceability
- **Alembic Migrations**: Schema-as-code for reproducible deployments

### Repo & Worktree Optimization
- **Central Bare Mirror**: Single clone of product repos reduces bandwidth and storage
- **Per-Task Worktrees**: Lightweight checkouts keyed by `repo+branch+commit`
- **LRU Eviction**: Automatic cleanup of stale worktrees
- **Allowlist Enforcement**: Validate repo/branch against admin configuration

### API & Routing
- **SSE/WebSocket Channels**: User-namespaced `tasks:{user_id}:{task_id}` for live updates
- **Admin Endpoints**: `/admin/tasks`, `/admin/metrics` (role-gated)
- **Task APIs**: POST/GET `/tasks`, GET `/tasks/{id}`, GET `/events/tasks/{id}`
- **Agent & Schedule APIs**: Full CRUD for agents and scheduled tasks

### Security & RBAC
- **Least-Privilege GitLab Scopes**: Read-only PAT enforcement
- **No Credential Storage**: PATs never persisted in task payloads
- **Path Sanitization**: Input validation on all repo/file paths
- **Secret Masking**: Logs scrubbed of sensitive data

### Observability
- **Per-User Metrics**: Track `tasks_created`, `tasks_completed`, `tokens_used` by user
- **Audit Logs**: Full activity logs with `user_id`, `task_id`, `repo_ref`, `action`, `timestamp`
- **Structured Logging**: JSON-formatted logs for easy parsing and analysis

---

## üìã Deployment Changes

### Clean Slate Deployment
- **Qdrant**: Wipe all collections before deploying v3.0.0
- **Database**: Truncate or drop/recreate; run Alembic migrations
- **Artifacts**: Clean build/dist directories

### Admin Setup
```bash
# Environment variables
export PG_URL="postgresql://user:pass@postgres:5432/intell_swe"
export GITLAB_CLIENT_ID="..."
export GITLAB_CLIENT_SECRET="..."
export OAUTH_REDIRECT_URI="https://intelligent-framework.mycorp.com/oauth/callback"

# Docker Compose startup
docker compose pull
docker compose up -d postgres redis qdrant
docker compose run --rm mcp alembic upgrade head
docker compose up -d mcp worker frontend
```

### User Onboarding
- Users open shared host URL ‚Üí authenticate via GitLab
- Submit tasks specifying `repo_ref` and `branch`
- Live updates stream via SSE channels
- Admin can monitor all tasks and usage metrics

---

## üîß Technical Improvements

- **Async Event Dispatch**: Task events persisted to DB and broadcast via SSE
- **Connection Pooling**: Optimized DB/Redis connection management
- **Feature Flags**: Enable/disable multiuser mode without code changes
- **Graceful Fallbacks**: SQLite available if Postgres unavailable; mock embeddings if OpenAI down
- **Idempotent Operations**: Task creation is retry-safe with deduplication

---

## üöÄ New CLI & Scripts

- `scripts/ensure_logo_in_artifacts.ps1`: Verify logo presence in all release artifacts
- Alembic migration commands for schema version management
- Admin utilities for user/role/repo configuration

---

## üìä Rollout Checklist

- [ ] Staging environment tested (Postgres, multiuser scoping, SSE isolation)
- [ ] Backups taken of old DBs/Qdrant collections
- [ ] Alembic migrations applied to target
- [ ] Feature flags set for multiuser mode
- [ ] Monitoring/alerts configured (task/token/error metrics)
- [ ] User onboarding guide published
- [ ] Fallback/rollback documentation ready

---

## üîÑ Migration Path

If upgrading from v2.4.0 (single-user rag-poc):
1. Deploy intell-swe v3.0.0 as new framework instance
2. rag-poc 2.4.0 (or later) becomes a **product** under analysis
3. Configure rag-poc ‚Üí intell-swe target repo in framework settings
4. Users authenticate via shared intell-swe URL (not per-user localhost)
5. Historical task/artifact data from rag-poc can be migrated if needed

---

## üìù Breaking Changes

- **Single-user mode removed**: All deployments now multiuser-capable (backward compatible but always scoped)
- **OAuth mandatory**: Anonymous access deprecated; GitLab auth required
- **Database schema changed**: Alembic migrations required; old SQLite DBs not directly compatible
- **Repo allowlist added**: Administrators must configure allowed repos/branches

---

## ‚úÖ Testing & Validation

- Full integration test suite for auth, per-user scoping, SSE isolation
- Load tests for concurrent users and SSE fan-out
- Repo cache behavior validation (hit rates, eviction)
- Admin visibility verified across multiuser scenarios
- Smoke tests with mock OpenAI and Qdrant included

---

## üìö Documentation

See:
- [docs/architecture/ARCHITECTURE_ANALYSIS.md](docs/architecture/ARCHITECTURE_ANALYSIS.md) - Design & multiuser plan
- [docs/IMPLEMENTATION_PLAN.md](docs/IMPLEMENTATION_PLAN.md) - Implementation steps
- [README.md](README.md) - Quick start & setup guide
- [Release notes](.) - Version history

---

**Questions or issues?** Contact the team or file an issue on GitHub: https://github.com/reginaldrhoe/intell-swe

Happy deployment! üöÄ
